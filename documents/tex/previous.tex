\chapter{Related Work}
\label{rw}
In rendering of subsurface scattering, all approaches rely on approximating correctly the \emph{Radiative Transport Equation} (RTE). We identified two main approaches to the problem in literature:

\begin{description}
	\item[Analytical] One class of solutions consists of approximating the RTE or one of its approximations via an analytical model. These model can have different level of complexity and computation times, and are often adaptable to a wide range of materials. However, often they rely on assumptions on the scattering parameters that limit their applicability.
	\item[Numerical] In this other class of solutions, a numerical solution for the RTE is actually computed. While providing an exact solution, the computation times are longer. When interactivity is needed, generally some heavy pre computation must be used.
\end{description}

\section{Analytical techniques}

In the analytical techniques, two different areas of research must be distinguished. The first area is the research on the actual models, while the second is research on how the actual models can be implemented efficiently. Each model is usually represented by a specific function called BSSRDF (\emph{Bidirectional Subsurface Scattering Reflectance Distribution Function}), that describes how light propagates between two points on the surface. This function in the general case must be calculated between all the couple of points on the surface and then integrated over each point. Implementation techniques focus on efficiently implementing this integration step, often making assumptions for which points the computation can be avoided. 

\subsection{Models}
Regarding the models, the first and most important is the dipole developed by \cite{Jensen:2001:PMS:383259.383319}. The models relies on an approximation of the RTE called the \emph{diffusion approximation}, that relies on the assumption on highly scattering materials. In this case, a BSSRDF for a planar surface in a semi-infinite medium can be obtained. The BSSRDF needs only the distance between two points to be calculated, and with some precautions can be also extended to arbitrary geometry. This model does not include any single scattering term, that needs to be evaluated separately. The model was then further extended in order to account for multi-layered materials\citep{Donner:2005:LDM:1186822.1073308}.

A significant improvement on the model was later given by \cite{deondeon}, that improved the model to better fit path traced simulations without any extra computation cost. A more advanced model based on quantization was proposed by \cite{D'Eon:2011:QMR:1964921.1964951}, that introduced a new physical foundation in order to improve the accuracy of the original diffusion approximation. Finally, some higher order approximation exist \citep{IMM2013-06646}, in order to account for the directionality of the incoming light and single scattering. This allows a more faithful representation of the model at the price of extended computation times.

Finally, for real-time critical applications (such as games), translucency is often estimated as a function of the thickness of the material, that is used to modify a lambertian term \citep{Tomaszewska2012}. While not physically accurate, this technique allows to have a fast translucency effect that can be easily added to existing deferred pipelines.

\subsection{Implementations}

Most research on efficient implementations of a subsurface scattering analytical model has been made on the original model by \cite{Jensen:2001:PMS:383259.383319}. The first efficient implementation was proposed by \cite{Jensen:2002:RHR:566654.566619}, based on a two-pass hierarchical integration approach. Samples on the model are organized in an octree data structure, that then is used to render the object. In the first step, the radiance from the light is stored in the points. In the second pass, using the octree, the contribution from neighboring points is computed, clustering far points in order to speed up calculations. In the original paper, the single scattering term is approximated with as a simple BRDF approximation.

\cite{Lensch:2002:IRT:826030.826632} approached the problem by subdividing the subsurface scattering contribution into two: a direct illumination part and a global illumination part (i.e. the light shining through the object). The global illumination part is pre-computed as vertex-to-vertex throughput and then summed to the direct illumination term in real-time. Translucent shadow maps \citep{Dachsbacher:2003:TSM:882404.882433} use an approach similar to standard shadow maps: they render the scene from the light point of view, and then calculate the dipole contribution in one point only from a selected set of points, according to a specified sampling pattern. As in \cite{Lensch:2002:IRT:826030.826632}, the contribution is split into global and local to permit faster computations. \cite{Mertens:2003:IRT:882404.882423} propose a fast technique based on radiosity hierarchical integration techniques, that unlike the previous implementation can handle deformable geometry.

Another important category of methods is screen space methods. \cite{1238246} propose an image space GPU technique that pre-computes a set of sample points for the area integration and then performs the integral over multiple GPU passes. \cite{d'Eon:2007:ERH:2383847.2383869} proposes a method in image-space, interpreting subsurface scattering as a sum of images to which a gaussian filter has been applied. The gaussians are then summed with weights that make them fit the diffusion approximation. \cite{Jimenez:2009:SPR:1609967.1609970} improves further the technique, giving more precise results in case of skin. \cite{4736459} present a fast technique that render the object as a series of splats, using GPU blending to sum over the various contributions.

Regarding more advanced models, the better and the quantized dipole can be applied to any of the previous implementations, since they do not require additional information that the standard dipole. On the other hand, the directional dipole requires the direction of the incoming light as part of its calculations, so it is generally not applicable to the mentioned implementations.  

\section{Numerical techniques}

Numerical techniques for subsurface scattering are often not specific, but come for free or as an extension of a global illumination numerical approximation, since the governing equations are essentially the same. Given their generality, they are usually slower that their analytical counterpart, and often rely on heavy pre-computation steps in order to achieve interactive framerates. Jensen's Photon Mapping\citep{Jensen:1998:ESL:280814.280925} was originally developed to render anisotropic subsurface scattering. Classical approaches as a full Monte-Carlo simulation implementation of the light-material interaction\citep{Dorsey:1999:MRW:311535.311560}, and finite-difference methods exist in literature\citep{raey}. 

Some less general methods have been introduced in order to devise more efficient approximations when it comes to the specific problem of subsurface scattering. \cite{raey} uses the diffusion approximation with the finite difference method on the object discretized on a 3D grid. \cite{Fattal:2009:PMI:1477926.1477933} uses as well a 3D grid, that is swept with a structure called light propagation map, that stores the intermediate results until the simulation is complete. 

\cite{journals/cgf/WangWHSYG10}, instead of performing the simulation on a discretized 3D grid, makes the propagation directly in the mesh, converting it into a connected grid of tetrahedrons called \emph{QuadGraph}. This grid can be optimized to be GPU cache friendly, and provide a real-time rendering of deformable heterogeneous objects. The problem in this method is that the QuadGraph is slow to compute (20 minutes for very complex meshes) and has heavy memory requirements for the GPU. 

Precomputed radiance transfer methods is another class of general global illumination methods, that generally pre-compute part of the lighting and store it in tables\citep{Donner:2009:EBM:1531326.1531336}, allowing to retrieve it efficiently with an additional memory cost.  

A recent method called SSLPV - Subsurface Scattering Light Propagation Volumes \citep{Borlum:2011:SSL:2018323.2018325} extends a technique originally developed by \cite{Kaplanyan:2010:CLP:1730804.1730821} to propagate light efficiently in a scene using a set of discretized directions on a 3D grid. The method allows real-time execution times and deformable meshes with no added pre-computation step, with the drawback of not being physically accurate. 

